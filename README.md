# 📅 班表模擬器 (Roster Simulator)

這是一個專為排班人員設計的輕量化 Web 工具，支援自動讀取 Excel 班表、檢測 11 小時休息時間，並提供智慧對調建議。

---

## 📑 改版紀錄 (Release Notes)

### 🚀 v3.0 - 2026-01-20
* **顏色預設邏輯優化**：新增判定機制，若 Excel 儲存格為「無填滿」，網頁人名將自動預設為黑色 (`#000000`)。
* **渲染校正**：修正部分 Excel 版本中「主題色 (Theme Color)」可能導致顏色抓取失敗的問題。
* **視覺強化**：微調文字陰影，兼顧淺色填色文字的可讀性與純黑文字的清晰度。

### 🎨 v2.9 - 2026-01-20
* **引擎更新**：全面捨棄 SheetJS (xlsx.js)，改採 **ExcelJS** 引擎，解決開源版無法讀取樣式的限制。
* **顏色讀取功能**：實現讀取 Excel 儲存格「填滿顏色」並同步顯示於人名，滿足班別外的人員分類需求。
* **相容性強化**：新增 `getCellVal` 邏輯，穩定處理 Excel 中的日期、公式與 RichText 物件，防止解析崩潰。
* **自動偵錯系統**：導入標題列自動掃描機制與 `Try-Catch` 報錯視窗。

### ⚖️ v2.5 - v2.6 - 2026-01-20
* **嚴格交集檢核**：連續選取多日對調時，系統僅會顯示「每一天皆符合資格」的全方位人選。
* **安全邊界檢查**：首創對調區間的 `n-1` 與 `n+1` 休息時間檢核，確保對調後不與前後日班表衝突。
* **原因透明化**：在「其餘人選」清單中明確標示「不符原因」與「原始班別」。

### 📱 v2.0 - 2026-01-20
* **批次對調功能**：新增多日連續區間一次性對調邏輯。
* **目標班別選單**：允許使用者指定想換成的目標班別（如指定換成 G 班）。
* **UI 響應式優化**：新增 PC/Mobile 視角切換與「✨金星」推薦標記。

### 🏗️ v1.0 - 2025-11-09
* **核心開發**：建立基礎 Excel 解析功能與 11 小時休息時間計算法。
* **介面建立**：實現日曆卡片式佈局與單日對調建議功能。

---

## 🛠️ 技術棧
* **Frontend**: HTML5, CSS3, JavaScript (ES6+)
* **Library**: [ExcelJS](https://github.com/exceljs/exceljs)
* **Logic**: 11-hour rest rule validation

## 📝 使用說明
1.  上傳包含「員工編號」、「員工姓名」及日期欄位的 `.xlsx` 班表。
2.  輸入您的員工編號進行鎖定。
3.  點擊日曆卡片選取欲對調的日期。
4.  系統將自動標記出符合勞基法（休息足夠）且班別相符的人選。
